<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>E-Shop Checkout</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .error-message {
            color: #EF4444;
            font-size: 0.875rem;
            margin-top: 0.25rem;
        }
        .success-message {
            color: #10B981;
            font-size: 0.875rem;
            margin-top: 0.25rem;
        }
        .valid-field {
            border-color: #10B981 !important;
        }
        .invalid-field {
            border-color: #EF4444 !important;
        }
    </style>
</head>
<body class="bg-gray-50">
    <div class="max-w-7xl mx-auto p-6">
        <!-- Header -->
        <header class="bg-white shadow-sm rounded-lg p-6 mb-6">
            <div class="flex justify-between items-center">
                <h1 class="text-3xl font-bold text-gray-900">E-Shop Checkout</h1>
                <div class="flex items-center space-x-4">
                    <div class="relative">
                        <svg class="w-8 h-8 text-gray-700" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z"></path>
                        </svg>
                        <span id="cart-count" class="absolute -top-2 -right-2 bg-red-500 text-white rounded-full w-6 h-6 flex items-center justify-center text-xs font-bold">0</span>
                    </div>
                </div>
            </div>
        </header>

        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
            <!-- Left Column: Products -->
            <div class="lg:col-span-2">
                <!-- Products Section -->
                <div class="bg-white shadow-sm rounded-lg p-6 mb-6">
                    <h2 class="text-2xl font-bold text-gray-900 mb-4">Products</h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4" id="products-container">
                        <!-- Product 1 -->
                        <div class="border rounded-lg p-4 hover:shadow-md transition">
                            <img src="https://via.placeholder.com/200x150?text=Smartphone" alt="Smartphone" class="w-full h-40 object-cover rounded mb-3">
                            <h3 class="font-semibold text-lg">Smartphone</h3>
                            <p class="text-gray-600">Latest model with advanced features</p>
                            <div class="flex justify-between items-center mt-3">
                                <span class="text-xl font-bold text-gray-900">$699</span>
                                <button onclick="addToCart('product-1', 'Smartphone', 699)" class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded font-medium" id="add-cart-product-1">Add to Cart</button>
                            </div>
                        </div>

                        <!-- Product 2 -->
                        <div class="border rounded-lg p-4 hover:shadow-md transition">
                            <img src="https://via.placeholder.com/200x150?text=Laptop" alt="Laptop" class="w-full h-40 object-cover rounded mb-3">
                            <h3 class="font-semibold text-lg">Laptop</h3>
                            <p class="text-gray-600">High-performance computing</p>
                            <div class="flex justify-between items-center mt-3">
                                <span class="text-xl font-bold text-gray-900">$1299</span>
                                <button onclick="addToCart('product-2', 'Laptop', 1299)" class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded font-medium" id="add-cart-product-2">Add to Cart</button>
                            </div>
                        </div>

                        <!-- Product 3 -->
                        <div class="border rounded-lg p-4 hover:shadow-md transition">
                            <img src="https://via.placeholder.com/200x150?text=Headphones" alt="Headphones" class="w-full h-40 object-cover rounded mb-3">
                            <h3 class="font-semibold text-lg">Headphones</h3>
                            <p class="text-gray-600">Premium sound quality</p>
                            <div class="flex justify-between items-center mt-3">
                                <span class="text-xl font-bold text-gray-900">$199</span>
                                <button onclick="addToCart('product-3', 'Headphones', 199)" class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded font-medium" id="add-cart-product-3">Add to Cart</button>
                            </div>
                        </div>

                        <!-- Product 4 -->
                        <div class="border rounded-lg p-4 hover:shadow-md transition">
                            <img src="https://via.placeholder.com/200x150?text=Smartwatch" alt="Smartwatch" class="w-full h-40 object-cover rounded mb-3">
                            <h3 class="font-semibold text-lg">Smartwatch</h3>
                            <p class="text-gray-600">Track your fitness goals</p>
                            <div class="flex justify-between items-center mt-3">
                                <span class="text-xl font-bold text-gray-900">$399</span>
                                <button onclick="addToCart('product-4', 'Smartwatch', 399)" class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded font-medium" id="add-cart-product-4">Add to Cart</button>
                            </div>
                        </div>

                        <!-- Product 5 -->
                        <div class="border rounded-lg p-4 hover:shadow-md transition md:col-span-2">
                            <img src="https://via.placeholder.com/200x150?text=Tablet" alt="Tablet" class="w-full h-40 object-cover rounded mb-3">
                            <h3 class="font-semibold text-lg">Tablet</h3>
                            <p class="text-gray-600">Entertainment on the go</p>
                            <div class="flex justify-between items-center mt-3">
                                <span class="text-xl font-bold text-gray-900">$499</span>
                                <button onclick="addToCart('product-5', 'Tablet', 499)" class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded font-medium" id="add-cart-product-5">Add to Cart</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Customer Information Form -->
                <div class="bg-white shadow-sm rounded-lg p-6 mb-6">
                    <h2 class="text-2xl font-bold text-gray-900 mb-4">Customer Information</h2>
                    <div class="space-y-4">
                        <div>
                            <label for="customer-name" class="block text-sm font-medium text-gray-700 mb-1">Full Name *</label>
                            <input type="text" id="customer-name" name="customer-name" class="w-full px-4 py-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="John Doe" required>
                            <div id="name-error" class="error-message hidden">⚠ Full Name is required</div>
                        </div>

                        <div>
                            <label for="customer-email" class="block text-sm font-medium text-gray-700 mb-1">Email Address *</label>
                            <input type="email" id="customer-email" name="customer-email" class="w-full px-4 py-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="john@example.com" required>
                            <div id="email-error" class="error-message hidden">⚠ Invalid email format</div>
                        </div>

                        <div>
                            <label for="customer-address" class="block text-sm font-medium text-gray-700 mb-1">Address</label>
                            <input type="text" id="customer-address" name="customer-address" class="w-full px-4 py-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="123 Main Street, City, State">
                        </div>

                        <div>
                            <label for="customer-phone" class="block text-sm font-medium text-gray-700 mb-1">Phone Number</label>
                            <input type="tel" id="customer-phone" name="customer-phone" class="w-full px-4 py-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="+1 234 567 8900">
                        </div>
                    </div>
                </div>

                <!-- Shipping Options -->
                <div class="bg-white shadow-sm rounded-lg p-6 mb-6">
                    <h2 class="text-2xl font-bold text-gray-900 mb-4">Shipping Method</h2>
                    <div class="space-y-3">
                        <label class="flex items-center p-3 border rounded cursor-pointer hover:bg-gray-50">
                            <input type="radio" name="shipping" value="standard" id="shipping-standard" class="w-4 h-4 text-blue-600" checked>
                            <div class="ml-3 flex-1">
                                <div class="font-medium">Standard Shipping</div>
                                <div class="text-sm text-gray-600">5-7 business days</div>
                            </div>
                            <div class="font-bold">Free</div>
                        </label>

                        <label class="flex items-center p-3 border rounded cursor-pointer hover:bg-gray-50">
                            <input type="radio" name="shipping" value="express" id="shipping-express" class="w-4 h-4 text-blue-600">
                            <div class="ml-3 flex-1">
                                <div class="font-medium">Express Shipping</div>
                                <div class="text-sm text-gray-600">2-3 business days</div>
                            </div>
                            <div class="font-bold">$10</div>
                        </label>
                    </div>
                </div>

                <!-- Payment Options -->
                <div class="bg-white shadow-sm rounded-lg p-6">
                    <h2 class="text-2xl font-bold text-gray-900 mb-4">Payment Method</h2>
                    <div class="space-y-3">
                        <label class="flex items-center p-3 border rounded cursor-pointer hover:bg-gray-50">
                            <input type="radio" name="payment" value="credit-card" id="payment-credit-card" class="w-4 h-4 text-blue-600" checked>
                            <div class="ml-3">
                                <div class="font-medium">Credit Card</div>
                            </div>
                        </label>

                        <label class="flex items-center p-3 border rounded cursor-pointer hover:bg-gray-50">
                            <input type="radio" name="payment" value="paypal" id="payment-paypal" class="w-4 h-4 text-blue-600">
                            <div class="ml-3">
                                <div class="font-medium">PayPal</div>
                            </div>
                        </label>

                        <label class="flex items-center p-3 border rounded cursor-pointer hover:bg-gray-50">
                            <input type="radio" name="payment" value="cod" id="payment-cod" class="w-4 h-4 text-blue-600">
                            <div class="ml-3">
                                <div class="font-medium">Cash on Delivery</div>
                            </div>
                        </label>
                    </div>
                </div>
            </div>

            <!-- Right Column: Cart and Summary -->
            <div class="lg:col-span-1">
                <!-- Cart Section -->
                <div class="bg-white shadow-sm rounded-lg p-6 mb-6 sticky top-6">
                    <h2 class="text-2xl font-bold text-gray-900 mb-4">Your Cart</h2>
                    <div id="cart-items" class="space-y-3 mb-4">
                        <p class="text-gray-500 text-center py-8">Your cart is empty. Start shopping!</p>
                    </div>

                    <!-- Discount Code -->
                    <div class="border-t pt-4 mb-4">
                        <label for="discount-code-input" class="block text-sm font-medium text-gray-700 mb-2">Discount Code</label>
                        <div class="flex space-x-2">
                            <input type="text" id="discount-code-input" class="flex-1 px-3 py-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500" placeholder="Enter code">
                            <button onclick="applyDiscount()" id="apply-discount-btn" class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded font-medium">Apply</button>
                        </div>
                        <div id="discount-message" class="mt-2 hidden"></div>
                    </div>

                    <!-- Order Summary -->
                    <div class="border-t pt-4 space-y-2">
                        <div class="flex justify-between text-gray-700">
                            <span>Subtotal:</span>
                            <span id="subtotal">$0.00</span>
                        </div>
                        <div class="flex justify-between text-gray-700">
                            <span>Discount:</span>
                            <span id="discount-amount" class="text-green-600">$0.00</span>
                        </div>
                        <div class="flex justify-between text-gray-700">
                            <span>Tax (10%):</span>
                            <span id="tax-amount">$0.00</span>
                        </div>
                        <div class="flex justify-between text-gray-700">
                            <span>Shipping:</span>
                            <span id="shipping-cost">Free</span>
                        </div>
                        <div class="flex justify-between text-xl font-bold text-gray-900 border-t pt-2">
                            <span>Total:</span>
                            <span id="final-total">$0.00</span>
                        </div>
                    </div>

                    <!-- Terms and Conditions -->
                    <div class="mt-4">
                        <label class="flex items-start">
                            <input type="checkbox" id="terms-checkbox" class="w-4 h-4 mt-1 text-blue-600">
                            <span class="ml-2 text-sm text-gray-700">I agree to the terms and conditions *</span>
                        </label>
                        <div id="terms-error" class="error-message hidden">⚠ You must accept terms and conditions</div>
                    </div>

                    <!-- Pay Now Button -->
                    <button onclick="checkout()" id="pay-now-btn" class="w-full bg-green-500 hover:bg-green-600 text-white font-bold py-3 px-4 rounded mt-4 disabled:bg-gray-400 disabled:cursor-not-allowed">
                        Pay Now
                    </button>

                    <!-- Success Message -->
                    <div id="success-message" class="hidden mt-4 p-4 bg-green-100 border border-green-400 text-green-700 rounded">
                        ✓ Order placed successfully! Thank you for your purchase.
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Cart state
        let cart = [];
        let appliedDiscount = null;

        // Product data
        const products = {
            'product-1': { name: 'Smartphone', price: 699 },
            'product-2': { name: 'Laptop', price: 1299 },
            'product-3': { name: 'Headphones', price: 199 },
            'product-4': { name: 'Smartwatch', price: 399 },
            'product-5': { name: 'Tablet', price: 499 }
        };

        // Discount codes
        const discountCodes = {
            'SAVE15': { type: 'percentage', value: 15, minOrder: 0 },
            'SAVE20': { type: 'percentage', value: 20, minOrder: 100 },
            'FLAT50': { type: 'flat', value: 50, minOrder: 200 }
        };

        // Add to cart
        function addToCart(productId, productName, price) {
            const existingItem = cart.find(item => item.id === productId);
            if (existingItem) {
                existingItem.quantity++;
            } else {
                cart.push({ id: productId, name: productName, price: price, quantity: 1 });
            }
            updateCart();
        }

        // Update cart display
        function updateCart() {
            const cartItems = document.getElementById('cart-items');
            const cartCount = document.getElementById('cart-count');
            
            if (cart.length === 0) {
                cartItems.innerHTML = '<p class="text-gray-500 text-center py-8">Your cart is empty. Start shopping!</p>';
                cartCount.textContent = '0';
            } else {
                const totalItems = cart.reduce((sum, item) => sum + item.quantity, 0);
                cartCount.textContent = totalItems;
                
                cartItems.innerHTML = cart.map(item => `
                    <div class="flex items-center space-x-3 border-b pb-3">
                        <img src="https://via.placeholder.com/60x60?text=${item.name}" class="w-16 h-16 object-cover rounded">
                        <div class="flex-1">
                            <div class="font-medium">${item.name}</div>
                            <div class="text-sm text-gray-600">$${item.price}</div>
                            <div class="flex items-center space-x-2 mt-1">
                                <button onclick="updateQuantity('${item.id}', -1)" class="w-6 h-6 bg-gray-200 rounded text-sm">-</button>
                                <span class="text-sm font-medium">${item.quantity}</span>
                                <button onclick="updateQuantity('${item.id}', 1)" class="w-6 h-6 bg-gray-200 rounded text-sm">+</button>
                            </div>
                        </div>
                        <button onclick="removeFromCart('${item.id}')" class="text-red-500 hover:text-red-700">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                            </svg>
                        </button>
                    </div>
                `).join('');
            }
            
            updateTotals();
        }

        // Update quantity
        function updateQuantity(productId, change) {
            const item = cart.find(i => i.id === productId);
            if (item) {
                item.quantity += change;
                if (item.quantity <= 0) {
                    removeFromCart(productId);
                } else {
                    updateCart();
                }
            }
        }

        // Remove from cart
        function removeFromCart(productId) {
            cart = cart.filter(item => item.id !== productId);
            updateCart();
        }

        // Calculate totals
        function updateTotals() {
            const subtotal = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            
            // Calculate discount
            let discountAmount = 0;
            if (appliedDiscount && discountCodes[appliedDiscount]) {
                const discount = discountCodes[appliedDiscount];
                if (subtotal >= discount.minOrder) {
                    if (discount.type === 'percentage') {
                        discountAmount = subtotal * (discount.value / 100);
                    } else {
                        discountAmount = discount.value;
                    }
                }
            }
            
            // Calculate shipping
            const shippingMethod = document.querySelector('input[name="shipping"]:checked').value;
            let shippingCost = 0;
            if (shippingMethod === 'express') {
                shippingCost = subtotal >= 500 ? 0 : 10;
            }
            
            // Calculate tax (10% on subtotal after discount)
            const taxableAmount = subtotal - discountAmount;
            const taxAmount = taxableAmount * 0.10;
            
            // Final total
            const finalTotal = subtotal - discountAmount + taxAmount + shippingCost;
            
            // Update display
            document.getElementById('subtotal').textContent = `$${subtotal.toFixed(2)}`;
            document.getElementById('discount-amount').textContent = discountAmount > 0 ? `-$${discountAmount.toFixed(2)}` : '$0.00';
            document.getElementById('tax-amount').textContent = `$${taxAmount.toFixed(2)}`;
            document.getElementById('shipping-cost').textContent = shippingCost === 0 ? 'Free' : `$${shippingCost.toFixed(2)}`;
            document.getElementById('final-total').textContent = `$${finalTotal.toFixed(2)}`;
        }

        // Apply discount code
        function applyDiscount() {
            const code = document.getElementById('discount-code-input').value.toUpperCase();
            const messageDiv = document.getElementById('discount-message');
            const subtotal = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            
            if (!code) {
                messageDiv.className = 'error-message mt-2';
                messageDiv.textContent = '⚠ Please enter a discount code';
                messageDiv.classList.remove('hidden');
                return;
            }
            
            if (!discountCodes[code]) {
                messageDiv.className = 'error-message mt-2';
                messageDiv.textContent = '⚠ Invalid discount code';
                messageDiv.classList.remove('hidden');
                appliedDiscount = null;
                updateTotals();
                return;
            }
            
            const discount = discountCodes[code];
            if (subtotal < discount.minOrder) {
                messageDiv.className = 'error-message mt-2';
                messageDiv.textContent = `⚠ Minimum order amount of $${discount.minOrder} required for this code`;
                messageDiv.classList.remove('hidden');
                appliedDiscount = null;
                updateTotals();
                return;
            }
            
            appliedDiscount = code;
            const discountAmount = discount.type === 'percentage' 
                ? subtotal * (discount.value / 100)
                : discount.value;
            
            messageDiv.className = 'success-message mt-2';
            messageDiv.textContent = `✓ Discount applied: ${code} - $${discountAmount.toFixed(2)}`;
            messageDiv.classList.remove('hidden');
            updateTotals();
        }

        // Form validation
        function validateForm() {
            let isValid = true;
            
            // Validate name
            const name = document.getElementById('customer-name');
            const nameError = document.getElementById('name-error');
            if (!name.value.trim()) {
                name.classList.add('invalid-field');
                nameError.classList.remove('hidden');
                isValid = false;
            } else {
                name.classList.remove('invalid-field');
                name.classList.add('valid-field');
                nameError.classList.add('hidden');
            }
            
            // Validate email
            const email = document.getElementById('customer-email');
            const emailError = document.getElementById('email-error');
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            if (!email.value.trim() || !emailRegex.test(email.value)) {
                email.classList.add('invalid-field');
                emailError.classList.remove('hidden');
                isValid = false;
            } else {
                email.classList.remove('invalid-field');
                email.classList.add('valid-field');
                emailError.classList.add('hidden');
            }
            
            // Validate terms
            const terms = document.getElementById('terms-checkbox');
            const termsError = document.getElementById('terms-error');
            if (!terms.checked) {
                termsError.classList.remove('hidden');
                isValid = false;
            } else {
                termsError.classList.add('hidden');
            }
            
            return isValid;
        }

        // Checkout
        function checkout() {
            // Check minimum order
            const subtotal = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            if (subtotal < 50) {
                alert('⚠ Minimum order amount is $50');
                return;
            }
            
            // Check if cart is empty
            if (cart.length === 0) {
                alert('⚠ Your cart is empty');
                return;
            }
            
            // Validate form
            if (!validateForm()) {
                return;
            }
            
            // Check payment method for COD
            const paymentMethod = document.querySelector('input[name="payment"]:checked').value;
            const finalTotal = parseFloat(document.getElementById('final-total').textContent.replace('$', ''));
            if (paymentMethod === 'cod' && finalTotal >= 300) {
                alert('⚠ Cash on Delivery is only available for orders below $300');
                return;
            }
            
            // Show loading
            const payBtn = document.getElementById('pay-now-btn');
            payBtn.disabled = true;
            payBtn.innerHTML = '<span class="inline-block animate-spin mr-2">⏳</span> Processing...';
            
            // Simulate payment processing
            setTimeout(() => {
                document.getElementById('success-message').classList.remove('hidden');
                payBtn.innerHTML = 'Pay Now';
                payBtn.disabled = false;
                
                // Reset form after 3 seconds
                setTimeout(() => {
                    cart = [];
                    appliedDiscount = null;
                    document.getElementById('discount-code-input').value = '';
                    document.getElementById('discount-message').classList.add('hidden');
                    document.getElementById('customer-name').value = '';
                    document.getElementById('customer-email').value = '';
                    document.getElementById('customer-address').value = '';
                    document.getElementById('customer-phone').value = '';
                    document.getElementById('terms-checkbox').checked = false;
                    document.getElementById('success-message').classList.add('hidden');
                    updateCart();
                }, 3000);
            }, 2000);
        }

        // Real-time validation on blur
        document.getElementById('customer-name').addEventListener('blur', function() {
            if (this.value.trim()) {
                this.classList.remove('invalid-field');
                this.classList.add('valid-field');
                document.getElementById('name-error').classList.add('hidden');
            }
        });

        document.getElementById('customer-email').addEventListener('blur', function() {
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            if (emailRegex.test(this.value)) {
                this.classList.remove('invalid-field');
                this.classList.add('valid-field');
                document.getElementById('email-error').classList.add('hidden');
            }
        });

        // Update totals when shipping changes
        document.querySelectorAll('input[name="shipping"]').forEach(radio => {
            radio.addEventListener('change', updateTotals);
        });
    </script>
</body>
</html>